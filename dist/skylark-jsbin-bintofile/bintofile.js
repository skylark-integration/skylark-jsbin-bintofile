/**
 * skylark-jsbin-bintofile - A version of jsbin-bintofile playground) that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-bintofile/
 * @license MIT
 */
define(["skylark-langx/skylark"],function(e){"use strict";var r=new RegExp(/^<!doctype[^>]*>\n?/im);function t(e,r,t){if(-1===e.toLowerCase().indexOf(r.toLowerCase()))return null;var s=e.substring(0,e.toLowerCase().lastIndexOf(r.toLowerCase())),i=e.substring(e.toLowerCase().lastIndexOf(r.toLowerCase())),n="";return s&&i&&(n=s+t+i),n}function s(e){return e.replace(/<\/script>/gi,"<\\/script>").replace(/<!--/g,"<\\!--")}return e.attach("intg.jsbin.bintofile",function(e,i){if(!e)return console.error("binToFile requires bin object",(new Error).stack),"<!DOCTYPE html>";i||(i={});var n=void 0!==i.proto?i.proto:"http:";n&&":"!==n.slice(-1)&&(n+=":");var o="",c=(e.html||"").replace(/(\r\n)/g,"\n"),a=e.source,l=s(e.css||""),p=s(e.javascript||""),f=e.processors||{},u=e.meta||(e.url?"\x3c!-- source: http://jsbin.com/"+e.url+"/"+(e.revision||"")+" --\x3e\n":"");if(c=c.replace(/(src|href)=('|")\/\//g,"$1=$2"+n+"//"),u&&"\n"!==u.slice(-1)&&(u+="\n"),o=c,l)if(-1!==o.indexOf("%css%"))o=o.split("%css%").join(e.css);else{var d=t(o,"</head>",l='<style id="jsbin-css">\n'+l+"\n</style>\n");if(d)o=d;else{var v=t(o,"</title>",l);o=v||l+o}}var h=(c.trim().split("\n").shift().trim().match(r)||[])[0]||"";if(o=h?o.replace(r,h+"\n"+u):u+o,p)if(-1!==o.indexOf("%code%"))o=o.split("%code%").join(p);else{var j=t(o,"</body>",(p='<script id="jsbin-javascript">\n'+p+"\n<\/script>")+"\n");o=j||o+"\n"+p}if(a){a.css===l&&delete a.css,a.javascript===p&&delete a.javascript,a.html===c&&delete a.html;var b=["html","css","javascript"].map(function(e){if(void 0===a[e])return"";var r=s(a[e]);return r?'\n<script id="jsbin-source-'+e+'" type="text/'+(f[e]||e)+'">'+r+"<\/script>":void 0}).join("\n"),g=t(o,"</body>",b);g?o=g:o+=b}var m=function(e){var r=0,t=0;if(0===e.length)return r;for(;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r&=r;return r.toString(16)}(o);return o=o.split("^^hash^^").join(m)})});
//# sourceMappingURL=sourcemaps/bintofile.js.map
